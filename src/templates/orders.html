<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    {% include "common/upgrade-requests.html" %}
    <title>{{ title_page }}</title>
    {% include "common/external.html" %}
    {% include "common/font.html" %}
    <link
            rel="stylesheet"
            type="text/css"
            href="/static/css/header.css"
    />
    <link
            rel="stylesheet"
            type="text/css"
            href="/static/css/orders.css"
    />
</head>
<body>
<div class="container">
    {% include "common/header.html" %}
    <div class="card">
        <div class="card-body">
            <select id="options-product" class="form-control" onchange="handlerOnChangeOptions(event)">
                <option value="" data-price="0">상품을 선택해주세요</option>
                {% for product in products %}
                    {% if product.stock > 0 %}
                        <option
                                value="{{ product.id }}"
                                data-price="{{ product.price }}"
                                data-stock="{{ product.stock }}"
                        >
                            {{ product.name }} (재고: {{ product.stock }})
                        </option>
                    {% endif %}
                {% endfor %}
            </select>
            <input
                    type="number"
                    id="quantity"
                    class="form-control order-quantity"
                    placeholder="주문 수량"
                    min="1"
                    onchange="handlerOnChangeQuantity(event)"
            />
            <p id="total-price" class="mt-3"></p>
            <input
                    type="text"
                    id="address"
                    class="form-control address"
                    placeholder="배송 주소"
            />
            <button onclick="createOrder()" class="btn btn-primary btn-block">주문하기</button>
        </div>
    </div>
    {% for order in orders %}
        <div class="card order">
            <h2>주문 번호: {{ order.order_id }}</h2>
            <h3>배송 주소: {{ order.address }} </h3>
            <div class="card-body">
                <input
                        type="text"
                        id="order-status-{{ order.id }}"
                        class="form-control"
                        value="주문 상태: {{ order.order_status }}"
                        readonly
                />
                <input
                        type="text"
                        id="delivery-status-{{ order.id }}"
                        class="form-control"
                        value="배송 상태: {{ order.delivery_status }}"
                        readonly
                />
                <hr/>
                {% for product in order.products %}
                    <input
                            type="text"
                            id="name-{{ product.id }}"
                            class="form-control"
                            value="상품명: {{ product.name }}"
                            readonly
                    />
                    <input
                            type="text"
                            id="unit-price-{{ product.id }}"
                            class="form-control"
                            value="상품 가격: {{ product.price }}원"
                            readonly
                    />
                    <input
                            type="text"
                            id="quantity-{{ product.id }}"
                            class="form-control"
                            value="주문 수량: {{ product.quantity }}개"
                            readonly
                    />
                    <hr/>
                    <input
                            type="text"
                            id="total-price-{{ product.id }}"
                            class="form-control"
                            value="총 주문 금액: {{ product.price * product.quantity }}원"
                            readonly
                    />
                {% endfor %}
                <div class="edit-buttons">
                    <button onclick="cancelOrder({{ order.order_id }})" class="btn btn-delete"><i
                            class="fas fa-trash-alt"></i></button>
                </div>
            </div>
        </div>
    {% endfor %}
</div>
<script src="/static/js/orders.js"></script>
</body>
</html>
